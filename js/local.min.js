var app=angular.module("localApp",[]);
app.controller("localCtrl",["$scope","$window","$http",function(a,d,c){a.campaign=!1;a.civic=!1;a.consumer=!1;a.criminal=!1;a.disability=!1;a.economic=!1;a.education=!1;a.environment=!1;a.gun=!1;a.health=!1;a.international=!1;a.immigration=!1;a.lgbtqia=!1;a.other=!1;a.racial=!1;a.voter=!1;a.women=!1;a.resTypes=[{name:"Campaign Finance Reform",show:"campaign"},{name:"Civic Involvement",show:"civic"},{name:"Consumer Rights",show:"consumer"},{name:"Criminal Justice",show:"criminal"},{name:"Disability",
show:"disability"},{name:"Economic Justice",show:"economic"},{name:"Education",show:"education"},{name:"Environment",show:"environment"},{name:"Gun Control",show:"gun"},{name:"Health Care",show:"health"},{name:"International",show:"international"},{name:"Immigration and Refugees",show:"immigration"},{name:"LGBTQIA",show:"lgbtqia"},{name:"Other",show:"other"},{name:"Racial Justice",show:"racial"},{name:"Voter Rights",show:"voter"},{name:"Women's Rights",show:"women"}];a.groups=[];c.get("../php/getGroups.php").then(function(b){a.groups=
b.data});a.hideLogin=!0;a.showFailedLogin=!1;a.invalidSubmit=!1;a.isValidLogin=!1;a.loginSubmit=function(){a.loginForm.$valid&&c.post("../php/login.php",a.loginInfo).then(function(b){"ok"===b.data.message?(a.hideLogin=!0,a.isValidLogin=!0):a.showFailedLogin=!0})};a.searchZip=function(){a.zipGroups=[];a.zips=[];a.zipDistance||(a.zipDistance=1);c.get("https://www.zipcodeapi.com/rest/js-HZv4WyW9j6pmudnHLGPBitoGhwnwGKsnJXrGwoQQvfc0tzIfgxQy1eeiLCPrmiO6/radius.json/"+a.zipSearch+"/"+a.zipDistance+"/miles").then(function(b){angular.forEach(b.data.zip_codes,
function(b){a.zips.push(b.zip_code)});a.zipGroups=$.grep(a.groups,function(b){return-1!=a.zips.indexOf(b.zip)})})};a.focusFilter=function(b){return"All"!==a.zipFocus&&a.zipFocus?-1<b.issues.indexOf(a.zipFocus):!0};a.selection=[];a.selectedIssues=function(){return filterFilter(a.resTypes,{selected:!0})};a.$watch("resTypes|filter:{selected:true}",function(b){a.selection=b.map(function(a){return a.name})},!0);a.isValidLink=function(a){return/^(#|http:\/\/|https:\/\/)/.test(a)};a.isValidZip=function(a){return/^\d{5}$/.test(a)};
a.addGroup=function(){a.isValidLogin&&(a.addGroupInfo.issues=0<a.selection.length?a.selection.join(", "):"",c.post("../php/addGroup.php",a.addGroupInfo).then(function(b){a.groups=b.data;a.addGroupInfo={};a.addForm.$setUntouched();for(i=0;i<a.resTypes.length;i++)a.resTypes[i].selected=!1}))};a.findGroup=function(){a.isValidLogin&&c.post("../php/findGroup.php",a.editGroupInfo.name).then(function(b){for(i=0;i<a.resTypes.length;i++)a.resTypes[i].selected=!1;a.editGroupInfo=b.data[0];if(""!==a.editGroupInfo.issues)for(b=
a.editGroupInfo.issues.split(", "),i=0;i<a.resTypes.length;i++)-1<b.indexOf(a.resTypes[i].name)&&(a.resTypes[i].selected=!0)})};a.editGroup=function(){a.isValidLogin&&(a.editGroupInfo.issues=0<a.selection.length?a.selection.join(", "):"",c.post("../php/editGroup.php",a.editGroupInfo).then(function(b){a.groups=b.data;a.editGroupInfo={};a.editForm.$setUntouched();for(i=0;i<a.resTypes.length;i++)a.resTypes[i].selected=!1}))}}]);