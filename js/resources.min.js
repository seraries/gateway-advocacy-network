var app=angular.module("resourceApp",[]);app.filter("resFilter",[function(){return function(a,d){var c=[];angular.forEach(a,function(a){0<=a.mainIssue.indexOf(d)&&c.push(a)});return c}}]);
app.controller("resourceCtrl",["$scope","$window","$http",function(a,d,c){a.campaign=!1;a.civic=!1;a.criminal=!1;a.disability=!1;a.economic=!1;a.education=!1;a.environment=!1;a.gun=!1;a.health=!1;a.immigration=!1;a.lgbtqia=!1;a.racial=!1;a.voter=!1;a.women=!1;a.resTypes=[{name:"Campaigns and Elections",show:"campaign"},{name:"Civic Involvement",show:"civic"},{name:"Criminal Justice",show:"criminal"},{name:"Disability",show:"disability"},{name:"Economic Justice",show:"economic"},{name:"Education",
show:"education"},{name:"Environment",show:"environment"},{name:"Gun Control",show:"gun"},{name:"Health Care",show:"health"},{name:"Immigration and Refugees",show:"immigration"},{name:"LGBTQIA",show:"lgbtqia"},{name:"Racial Justice",show:"racial"},{name:"Voter Rights",show:"voter"},{name:"Women's Rights",show:"women"}];a.resources=[];c.get("../php/getResources.php").then(function(b){a.resources=b.data});a.toggleBtn=function(b){angular.forEach(a.resTypes,function(c){c.show!=b&&(a[c.show]=!1)});a[b]=
!a[b]};a.hideLogin=!0;a.showFailedLogin=!1;a.invalidSubmit=!1;a.isValidLogin=!1;a.loginSubmit=function(){a.loginForm.$valid&&c.post("../php/login.php",a.loginInfo).then(function(b){"ok"===b.data.message?(a.hideLogin=!0,a.isValidLogin=!0):a.showFailedLogin=!0})};a.selection=[];a.selectedIssues=function(){return filterFilter(a.resTypes,{selected:!0})};a.$watch("resTypes|filter:{selected:true}",function(b){a.selection=b.map(function(a){return a.name})},!0);a.addResource=function(){a.isValidLogin&&(a.addResInfo.otherIssues=
0<a.selection.length?a.selection.join(", "):"",c.post("../php/addResource.php",a.addResInfo).then(function(b){a.resources=b.data;a.addResInfo={};a.issue={}}))};a.findResource=function(){a.isValidLogin&&c.post("../php/findResource.php",a.editResInfo.name).then(function(b){a.editResInfo=b.data[0]})};a.editResource=function(){a.isValidLogin&&(a.editResInfo.otherIssues=0<a.selection.length?a.selection.join(", "):"",c.post("../php/editResource.php",a.editResInfo).then(function(b){a.resources=b.data;a.editResInfo=
{};a.editForm.$setUntouched();a.issue={}}))}}]);